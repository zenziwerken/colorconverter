<html>
<head>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23000' stroke-width='2'%3E%3Cpath stroke='none' d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M12.1 23.5h-.2C5.6 23.5.5 18.3.5 12S5.7.5 12 .5 23.5 5.2 23.5 11c0 1.8-.8 3.5-2.2 4.7-1.3 1.2-3 1.8-4.8 1.8h-1.3c1 1.4.9 3.4-.3 4.8-.7.8-1.7 1.2-2.8 1.2z' stroke-width='0' fill='%23fff'/%3E%3Cpath fill='%23fff' d='M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25' /%3E%3Cpath stroke='%23f00' d='M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0' /%3E%3Cpath stroke='%230f0' d='M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0' /%3E%3Cpath stroke='%2300f' d='M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0' /%3E%3C/svg%3E" />
    <title>HEX RGB &#8594; HEX CMYK</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="height=device-height, initial-scale=1.0">
    <link rel="manifest" href="website.manifest">
    <style>
        @font-face {
            font-family: 'Open Sans';
            font-style: normal;
            font-weight: 400;
            font-stretch: 100%;
            font-display: swap;
            src: local('Open Sans'), local('OpenSans'), url(https://fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-muw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
        }

        @font-face {
            font-family: 'Open Sans';
            font-style: normal;
            font-weight: 700;
            font-stretch: 100%;
            font-display: swap;
            src: local('Open Sans Bold'), local('OpenSans-Bold'), url(https://fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-muw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
        }

        body {
            font-family: "Open Sans", "Arial", "Helvetica", sans-serif;
            background-color: #F4F4F9;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            height: 100svh;
            margin: 0;
        }

        h1 {
            color: #333333;
            font-size: 24px;
            text-align: center;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
            margin: 10px 0 0 0;
        }
        .icon {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none' stroke='%23000' stroke-width='2'%3E%3Cpath d='M0 0h24v24H0z' stroke='none'/%3E%3Cpath fill='%23fff' d='M12 21a9 9 0 0 1 0-18c4.97 0 9 3.582 9 8 0 1.06-.474 2.078-1.318 2.828-.844.75-1.989 1.172-3.182 1.172H14a2 2 0 0 0-1 3.75A1.3 1.3 0 0 1 12 21'/%3E%3Cpath stroke='red' d='M7.5 10.5a1 1 0 1 0 2 0 1 1 0 1 0-2 0'/%3E%3Cpath stroke='%230f0' d='M11.5 7.5a1 1 0 1 0 2 0 1 1 0 1 0-2 0'/%3E%3Cpath stroke='%2300f' d='M15.5 10.5a1 1 0 1 0 2 0 1 1 0 1 0-2 0'/%3E%3C/svg%3E");
            display: inline-block;
            height: 1.2em;
            width: 1.2em;
            vertical-align: -0.2em;
            background-repeat: no-repeat;
            background-size: contain;
        }

        .container {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 360px;
        }

        .section {
            padding: 10px 20px 10px;
            border-bottom: 1px solid #ddd;
            transition: background-color .2s ease-in-out;
        }

        label {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
            display: block;
        }

        input[type="text"],
        input[type="number"] {
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: calc(33.333% - 10px);
            box-sizing: border-box;
            transition: box-shadow .2s ease-in-out;
        }

        input#HEXCMYK,
        input#HEXRGB {
            width: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='30' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='10' y='20' fill='%23eee' font-family='Open Sans' font-weight='700'%3E%23%3C/text%3E%3C/svg%3E");
            background-position: -6px 1px;
            background-repeat: no-repeat;
            padding-left: 26px;
            background-size: 40%;
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        input[type="text"],
        input[type="button"],
        input[type="number"] {
            font-size: 1rem;
            font-family: "Open Sans", sans-serif;
        }

        input[type="text"]:focus,
        input[type="number"]:focus {
            box-shadow: 0 0 0 3px rgba(0, 56, 115, 0.25);
            outline: none;
        }

        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            appearance: textfield;
            -moz-appearance: textfield;
        }

        input#R,
        input#G,
        input#B,
        input#C,
        input#M,
        input#Y,
        input#K {
            background-size: 150%;
            background-position: -8px 0px;
            background-repeat: no-repeat;
            text-align: end;
        }

        input#C,
        input#M,
        input#Y,
        input#K {
            background-size: 200%;
        }

        input#R {
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='30' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='10' y='20' fill='%23eee' font-family='Open Sans' font-weight='700'%3ER%3C/text%3E%3C/svg%3E");
        }

        input#G {
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='30' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='10' y='20' fill='%23eee' font-family='Open Sans' font-weight='700'%3EG%3C/text%3E%3C/svg%3E");
        }

        input#B {
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='30' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='10' y='20' fill='%23eee' font-family='Open Sans' font-weight='700'%3EB%3C/text%3E%3C/svg%3E");
        }

        input#C {
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='30' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='10' y='20' fill='%23eee' font-family='Open Sans' font-weight='700'%3EC%3C/text%3E%3C/svg%3E");
        }

        input#M {
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='30' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='10' y='20' fill='%23eee' font-family='Open Sans' font-weight='700'%3EM%3C/text%3E%3C/svg%3E");
        }

        input#Y {
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='30' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='10' y='20' fill='%23eee' font-family='Open Sans' font-weight='700'%3EY%3C/text%3E%3C/svg%3E");
        }

        input#K {
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='30' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='10' y='20' fill='%23eee' font-family='Open Sans' font-weight='700'%3EK%3C/text%3E%3C/svg%3E");
        }

        input[type="button"] {
            padding: 10px;
            border: none;
            border-radius: 4px;
            background-color: #999;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s;
            width: calc(100% - 40px);
            margin: 20px 20px 10px;
        }

        input[type="button"]:hover {
            background-color: #666;
        }

        #representation {
            width: 100%;
            height: 50px;
            border-radius: 0 0 8px 8px;
            margin-top: 10px;
            background: linear-gradient(135deg, #fff 0%, #f9f9f9 40%, #eee 50%, #f9f9f9 60%, #fff 100%);
            background-size: 400% 400%;
            animation: placeholder-animation 2s infinite alternate-reverse;
        }

        @keyframes placeholder-animation {
            0% {
                background-position: 0
            }

            100% {
                background-position: 100%
            }
        }

        .modified {
            background-color: #eee;
        }

        .modal {
            display: flex;  
            visibility: hidden;  
            opacity: 0;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
            transition: opacity 0.2s;
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px 25px;
            border: 1px solid #888;
            width: 50%;
            border-radius: 8px;
            box-shadow: 2px 2px 10px #3336;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            margin-top: -0.5rem;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        #infobtn {
            cursor: pointer;
            font-size: 0.9rem;
            margin-left: 0.2rem;
            color: #fff;
            background-color: #999;
            border-radius: 50%;
            width: 1rem;
            line-height: 1rem;
            vertical-align: 2px;
            display: inline-block;
        }
        
        @media (max-width: 50em) { 
            body {
                align-items: flex-start;
                padding-top: 1rem;
            }
            .container {
                margin-top: 1rem;
            }
            .modal {
                h1 {
                    font-size: 1.1rem;
                }
                p {
                    font-size: 0.9rem;
                }
            }
            .modal-content {
                padding: 12px 15px;
                width: 80%;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1><span class="icon"></span> Color Converter <span id="infobtn">?</span></h1>
        <div class="section" id="hex_rgb">
            <label>HEX RGB</label>
            <input type="text" id="HEXRGB" value="FFFFFF">
        </div>

        <div class="section" id="dec_rgb">
            <label>DEC RGB</label>
            <div class="input-group">
                <input type="number" id="R" value="255" class="rgb" pattern="[0-9]*" min="0" max="255" inputmode="decimal">
                <input type="number" id="G" value="255" class="rgb" pattern="[0-9]*" min="0" max="255" inputmode="decimal">
                <input type="number" id="B" value="255" class="rgb" pattern="[0-9]*" min="0" max="255" inputmode="decimal">
            </div>
        </div>

        <div class="section" id="dec_cmyk">
            <label>DEC CMYK</label>
            <div class="input-group">
                <input type="number" id="C" value="0" class="cmyk" pattern="[0-9]*" min="0" max="100" inputmode="decimal">
                <input type="number" id="M" value="0" class="cmyk" pattern="[0-9]*" min="0" max="100" inputmode="decimal">
                <input type="number" id="Y" value="0" class="cmyk" pattern="[0-9]*" min="0" max="100" inputmode="decimal">
                <input type="number" id="K" value="0" class="cmyk" pattern="[0-9]*" min="0" max="100" inputmode="decimal">
            </div>
        </div>

        <div class="section" id="hex_cmyk">
            <label>HEX CMYK</label>
            <input type="text" id="HEXCMYK" value="00000000">
        </div>

        <input type="button" value="calculate" onclick="calculate()">
        <div id="representation"></div>
    </div>
    <div id="info" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <h1><span class="icon"></span> Color Converter</h1>
          <p>Simple html/javascript page to convert color from hex rgb to hex cmyk and back</p>
            <p>Enter any value in one of the input fields and the corresponding other fields will be calculated when you leave the field. 
                You can also hit the Enter key or the 'calculate'-button. 
                If you enter values outside the permitted limits, meaningful values are inserted.
                The field below shows a representation of the entered color.</p>
            <p>You can use this page online or you can download the html-file and use it offline.</p>
            <p>Find the most recent code at <a target="_blank" href="https://github.com/zenziwerken/colorconverter">https://github.com/&#8203zenziwerken/&#8203colorconverter</a></p>
        </div>
      </div>

    <script>
        document.querySelectorAll('input[type="text"], input[type="number"]').forEach(input => {
            input.addEventListener('input', function () {
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('modified');
                });

                const section = input.closest('.section');
                if (section) {
                    section.classList.add('modified');
                }
                input.addEventListener('blur', function () {
                    calculate();
                });
            });
        });

        window.addEventListener('keyup', function (event) {
            if (event.keyCode === 13) {
                calculate();
            }
            if (event.key === "Escape") {
                document.activeElement.blur();
            }
        });

        function calculate() {
            const modifiedSection = document.querySelector('.section.modified');

            if (modifiedSection) {
                const sectionId = modifiedSection.id;

                switch (sectionId) {
                    case 'hex_rgb':
                        if (calculate_hexrgb_to_decrgb()) {
                            calculate_decrgb_to_deccmyk();
                            calculate_deccmyk_to_hexcmyk();
                        }
                        break;
                    case 'dec_rgb':
                        calculate_decrgb_to_hexrgb();
                        calculate_decrgb_to_deccmyk();
                        calculate_deccmyk_to_hexcmyk();
                        break;
                    case 'dec_cmyk':
                        calculate_deccmyk_to_decrgb();
                        calculate_decrgb_to_hexrgb();
                        calculate_deccmyk_to_hexcmyk();
                        break;
                    case 'hex_cmyk':
                        if (calculate_hexcmyk_to_deccmyk()) {
                            calculate_deccmyk_to_decrgb();
                            calculate_decrgb_to_hexrgb();
                        }
                        break;
                }
            }
        }

        function set_representation(hexa) {
            var representation = document.getElementById('representation');
            representation.style.animation = 'none';
            representation.style.background = 'none';
            representation.style.backgroundColor = hexa;
        }

        function calculate_hexcmyk_to_deccmyk() {
            var hexa = document.getElementById("HEXCMYK").value;
            var cmyk = [];
            var tmp, i;

            if (hexa.length < 1) return false;

            if (hexa.substr(0, 1) == '#') {
                hexa = hexa.substr(1);
                document.getElementById("HEXCMYK").value = hexa;
            }

            if (hexa.length === 4) {
                tmp = hexa.split("");
                hexa = '';
                for (i = 0; i < 4; i++) {
                    cmyk.push(parseInt(tmp[i] + "" + tmp[i], 16));
                    hexa += tmp[i] + "" + tmp[i];
                }
            } else if (hexa.length === 8) {
                tmp = hexa.match(/.{2}/g);
                for (i = 0; i < 4; i++) {
                    cmyk.push(parseInt(tmp[i], 16));
                }
            } else {
                document.getElementById("HEXCMYK").value = '00000000';
                alert("'" + hexa + "' is not a valid hex format");
                return false;
            }

            document.getElementById("HEXCMYK").value = hexa.toUpperCase();
            document.getElementById("C").value = Math.round(cmyk[0] / 255 * 100);
            document.getElementById("M").value = Math.round(cmyk[1] / 255 * 100);
            document.getElementById("Y").value = Math.round(cmyk[2] / 255 * 100);
            document.getElementById("K").value = Math.round(cmyk[3] / 255 * 100);
            return true;
        }

        function calculate_deccmyk_to_decrgb() {
            var c = document.getElementById("C").value;
            var m = document.getElementById("M").value;
            var y = document.getElementById("Y").value;
            var k = document.getElementById("K").value;
            if (c == null || isNaN(c) || c == '' || c < 0) { c = 0; document.getElementById("C").value = 0; }
            if (m == null || isNaN(m) || m == '' || m < 0) { m = 0; document.getElementById("M").value = 0; }
            if (y == null || isNaN(y) || y == '' || y < 0) { y = 0; document.getElementById("Y").value = 0; }
            if (k == null || isNaN(k) || k == '' || k < 0) { k = 0; document.getElementById("K").value = 0; }
            if (c > 100) { c = 100; document.getElementById("C").value = 100; }
            if (m > 100) { m = 100; document.getElementById("M").value = 100; }
            if (y > 100) { m = 100; document.getElementById("Y").value = 100; }
            if (k > 100) { k = 100; document.getElementById("K").value = 100; }
            k = Math.min(k, 100);

            computedR = 255 * (1 - c / 100) * (1 - k / 100);
            computedG = 255 * (1 - m / 100) * (1 - k / 100);
            computedB = 255 * (1 - y / 100) * (1 - k / 100);

            document.getElementById("R").value = Math.max(0, Math.round(computedR));
            document.getElementById("G").value = Math.max(0, Math.round(computedG));
            document.getElementById("B").value = Math.max(0, Math.round(computedB));
        }

        function calculate_decrgb_to_hexrgb() {
            const r = parseInt(document.getElementById("R").value) || 0;
            const g = parseInt(document.getElementById("G").value) || 0;
            const b = parseInt(document.getElementById("B").value) || 0;

            const hex = decimalToHexString(r) + decimalToHexString(g) + decimalToHexString(b);
            document.getElementById("HEXRGB").value = hex;
            set_representation(hex);
        }

        function calculate_hexrgb_to_decrgb() {
            var hexa = document.getElementById("HEXRGB").value;
            var rgb = [];
            var tmp, i;
            if (hexa.length < 1) return false;

            if (hexa.substr(0, 1) == '#') {
                hexa = hexa.substr(1);
                document.getElementById("HEXRGB").value = hexa;
            }

            if (hexa.length === 3) {
                tmp = hexa.split("");
                hexa = '';
                for (i = 0; i < 3; i++) {
                    rgb.push(parseInt(tmp[i] + "" + tmp[i], 16));
                    hexa += tmp[i] + "" + tmp[i];
                }
            } else if (hexa.length === 6) {
                tmp = hexa.match(/.{2}/g);
                for (i = 0; i < 3; i++) {
                    rgb.push(parseInt(tmp[i], 16));
                }
            } else {
                document.getElementById("HEXRGB").value = '000000';
                alert("'" + hexa + "' is not a valid hex format");
                return false;
            }

            document.getElementById("R").value = rgb[0];
            document.getElementById("G").value = rgb[1];
            document.getElementById("B").value = rgb[2];
            document.getElementById("HEXRGB").value = hexa.toUpperCase();
            set_representation(hexa);
            return true;
        }

        function calculate_decrgb_to_deccmyk() {
            var computedC = 0;
            var computedM = 0;
            var computedY = 0;
            var computedK = 0;

            var r = parseInt(document.getElementById("R").value);
            var g = parseInt(document.getElementById("G").value);
            var b = parseInt(document.getElementById("B").value);

            if (r == null || isNaN(r) || r == '' || r < 0) { r = 0; document.getElementById("R").value = 0; }
            if (g == null || isNaN(g) || g == '' || g < 0) { g = 0; document.getElementById("G").value = 0; }
            if (b == null || isNaN(b) || b == '' || b < 0) { b = 0; document.getElementById("B").value = 0; }

            if (r > 255) { r = 255; document.getElementById("R").value = 255; }
            if (g > 255) { g = 255; document.getElementById("G").value = 255; }
            if (b > 255) { b = 255; document.getElementById("B").value = 255; }

            computedC = 1 - (r / 255);
            computedM = 1 - (g / 255);
            computedY = 1 - (b / 255);

            var minCMY = Math.min(computedC, Math.min(computedM, computedY));
            computedC = (computedC - minCMY) / (1 - minCMY);
            computedM = (computedM - minCMY) / (1 - minCMY);
            computedY = (computedY - minCMY) / (1 - minCMY);
            computedK = minCMY;

            if (r == 0 && g == 0 && b == 0) {
                computedC = 0;
                computedM = 0;
                computedY = 0;
                computedK = 1;
            }

            document.getElementById("C").value = Math.round(computedC * 100);
            document.getElementById("M").value = Math.round(computedM * 100);
            document.getElementById("Y").value = Math.round(computedY * 100);
            document.getElementById("K").value = Math.round(computedK * 100);

        }

        function calculate_deccmyk_to_hexcmyk() {
            var c = document.getElementById("C").value;
            var m = document.getElementById("M").value;
            var y = document.getElementById("Y").value;
            var k = document.getElementById("K").value;

            if (c == null || isNaN(c) || c == '' || c < 0) { c = 0; document.getElementById("C").value = 0; }
            if (m == null || isNaN(m) || m == '' || m < 0) { m = 0; document.getElementById("M").value = 0; }
            if (y == null || isNaN(y) || y == '' || y < 0) { y = 0; document.getElementById("Y").value = 0; }
            if (k == null || isNaN(k) || k == '' || k < 0) { k = 0; document.getElementById("K").value = 0; }

            if (c > 100) { c = 100; document.getElementById("C").value = 100; }
            if (m > 100) { m = 100; document.getElementById("M").value = 100; }
            if (y > 100) { m = 100; document.getElementById("Y").value = 100; }
            if (k > 100) { k = 100; document.getElementById("K").value = 100; }

            k = Math.min(k, 100);

            document.getElementById("HEXCMYK").value = String(decimalToHexString(Math.round(c / 100 * 255)));
            document.getElementById("HEXCMYK").value += String(decimalToHexString(Math.round(m / 100 * 255)));
            document.getElementById("HEXCMYK").value += String(decimalToHexString(Math.round(y / 100 * 255)));
            document.getElementById("HEXCMYK").value += String(decimalToHexString(Math.round(k / 100 * 255)));

            computedR = 255 * (1 - c / 100) * (1 - k / 100);
            computedG = 255 * (1 - m / 100) * (1 - k / 100);
            computedB = 255 * (1 - y / 100) * (1 - k / 100);
        }

        function decimalToHexString(number) {
            if (number < 0) number = 0xFFFFFFFF + number + 1;
            return number.toString(16).toUpperCase().padStart(2, '0');
        }

        var modal = document.getElementById("info");
        var btn   = document.getElementById("infobtn");
        var span  = document.getElementsByClassName("close")[0];
        btn.onclick = function() {
            modal.style.visibility = "visible";
            modal.style.opacity = 1;
        }

        span.onclick = function() {
            modal.style.visibility = 'hidden'; 
            modal.style.opacity = 0;
        }


    </script>
</body>

</html>